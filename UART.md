# UART

## 简介

​	通用异步收发传输器（Universal Asynchronous Receiver/Transmitter,通常称作UART）是一种串行异步收发协议，应用十分广泛。UART工作原理是将数据的二进制位一位一位的进行传输。在UART通讯协议中信号线伤的状态位高电平代表‘1’低电平代表‘0’.**当然两个设备使用UART串口通讯时，必须先约定好传输速率和一些数据位**。

## 硬件连接

​	硬件的连接比较简单，仅需要3条线，**注意连接时两个设备UART电平，如电平范围不一致请坐电平转换后在连接，**如下图所示：

* TX：发送数据端，要接对面设备的RX
* RX：接收数据端，要接对面设备的TX
* GND:保证两设备共地，有统一的参考平面

![image-20210709142858089](C:\Users\22859\AppData\Roaming\Typora\typora-user-images\image-20210709142858089.png)

****

## 软件通信协议

​	UART作为异步串口通信协议的一种，工作原理是将数据的字节一位接一位地传输。协议如下：
![image-20210709144016653](C:\Users\22859\AppData\Roaming\Typora\typora-user-images\image-20210709144016653.png)

#### 空闲位：

UART协议规定，当总线处于空闲状态时信号线的状态为‘1’即高电平。

#### 起始位：

开始进行数据传输时发送方要先发出一个低电平‘0’来表示传输字符的开始。因为空闲位一直是高电平所以开始第一次通讯时先发送一个明显区别于空闲状态的信号即为低电平。

#### 数据位：

起始位之后就是要传输的数据，数据可以时5，6，7，8，9位，构成一个字符，一i

数据位传送完成后，要进行奇偶校验，校验位其实就是调整个数，串口校验分几种方式：

1.无校验（no parity）

2.奇校验（odd parity）:如果数据位中‘1’的数目时偶数，则校验位为'1'，如果'1'的数目是奇数，校验位为‘0’。

3.偶校验(even parity):如果数据位中'1'的数目是偶数，则校验位为‘0’，如果为奇数，校验位为‘1’。

3.mark parity:校验位始终为1。

4.space parity:校验位始终为0。

#### 停止位：

数据结束标志，可以是1位，1.5位，2位的高电平。

#### 波特率

数据传输速率使用波特率来表示，单位bps(bits per secpnd）,常见的波特率9600bps,11520bps等等，其他标准的波特率是1200，2400，4800，19200，38400，57600。举个例子，如果串口波特率设置位9600bps,那么传输一个比特需要的时间是1/9600≈104.2us。![image-20210709151522128](C:\Users\22859\AppData\Roaming\Typora\typora-user-images\image-20210709151522128.png)

以9600 8N1（9600波特率，8个数据位，没有校验位，1位停止位）为例，这是目前最常用的串口配置，现在我们传输‘O’‘K’两个ASCII值，‘O’的ASCII为79，对应的二进制数据为**01001111**，‘K’对应的二进制数据为**01001011**，传输的格式数据如下图所示：

![image-20210709151919996](C:\Users\22859\AppData\Roaming\Typora\typora-user-images\image-20210709151919996.png)

串口波特率为9600，1bit传输时间大约为104us,传送一个数据实际是10个比特（开始位，8个数据位，停止位），一个bytes传输速率实际为9600*8/10=7680bps。

***

### 时间累计误差

​	uart在传输数据的时候由于双方时钟可能会有略微的误差，长久之后可能会导致后面的数据都是错位的，所以uart传输只能一次传输1个字节。