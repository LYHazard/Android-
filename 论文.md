基于网络的入侵检测和数据泄露防御系统通过检测报文来检测恶意软件或机密文档等关键文件是否传输，然而，这种检测在重组数据包时需要大量的计算资源，并且只能解释已知的协议。此外，从存储中找到相似的文件还需要两两比较。本文提供了一种新的基于网络的文件识别方案，该方案独立检测数据包而不进行重组，通过反向索引而不是两两比较找到相似的文件。我们使用一种基于内容的分块算法来一致地将文件和包划分为多个字节序列，称为块。如果一个包时一个文件的一部分，那么它们将具有共同的块。具有挑战性的问题时数据包分块和反向索引搜索对于数据包处理来说应该足够快和可拓展。文件识别应该是准确的，尽管许多块是噪声，在本文中，我们使用的是一个小Bloom过滤器[1]和一个延迟查询来解决这个问题。

基于网络的入侵检测系统（IDS）[2]和数据泄露预防系统（DLP）对网络流量进行监控和报文检测。它们检测关键文件，如恶意软件下载或机密文件是否通过网络传输。在本文中，我们将那些不应该通过安全策略在网络上传输的文件称为关键文件。关键文件可以在主机级或网络级识别。我们的重点是基于网络的关键文件检测包检测。

**布隆过滤器［1］**（Bloom Filter）是由布隆（Burton Howard Bloom）在1970年提出的。它实际上是由一个很长的二进制向量和一系列随机映射函数组成，布隆过滤器可以用于检索一个元素是否在一个集合中。它的优点是空间效率和查询时间都远远超过一般的算法，缺点是有一定的误识别率

**IDS[2]**:IDS是计算机的监视系统，它通过实时监视系统，一旦发现异常情况就发出警告。 以信息来源的不同和检测方法的差异分为几类：根据信息来源可分为基于主机IDS和基于网络的IDS，根据检测方法又可分为异常[入侵检测](https://baike.baidu.com/item/入侵检测)和误用入侵检测。不同于[防火墙](https://baike.baidu.com/item/防火墙)，[IDS入侵检测](https://baike.baidu.com/item/IDS入侵检测/5486773)系统是一个监听设备，没有跨接在任何[链路](https://baike.baidu.com/item/链路)上，无须[网络流量](https://baike.baidu.com/item/网络流量)流经它便可以工作。